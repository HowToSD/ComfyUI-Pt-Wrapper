{"last_node_id":87,"last_link_id":133,"nodes":[{"id":50,"type":"PtTrainClassificationModel","pos":[2205.1328125,2001.00634765625],"size":[243.70773315429688,214],"flags":{},"order":32,"mode":0,"inputs":[{"name":"model","type":"PTMODEL","link":118,"localized_name":"model"},{"name":"train_loader","type":"PTDATALOADER","link":66,"localized_name":"train_loader"},{"name":"optimizer","type":"PTOPTIMIZER","link":68,"localized_name":"optimizer"},{"name":"val_loader","type":"PTDATALOADER","link":67,"shape":7,"localized_name":"val_loader"}],"outputs":[{"name":"Model","type":"PTMODEL","links":[71],"slot_index":0,"localized_name":"Model"},{"name":"train loss","type":"TENSOR","links":null,"localized_name":"train loss"},{"name":"val loss","type":"TENSOR","links":null,"localized_name":"val loss"}],"properties":{"Node name for S&R":"PtTrainClassificationModel"},"widgets_values":[5,true,false,10,true]},{"id":11,"type":"PtoAdam","pos":[2205.1328125,1709.9505615234375],"size":[265.8851013183594,108.32855224609375],"flags":{},"order":31,"mode":0,"inputs":[{"name":"model","type":"PTMODEL","link":117,"localized_name":"model"}],"outputs":[{"name":"PTOPTIMIZER","type":"PTOPTIMIZER","links":[68],"slot_index":0,"localized_name":"PTOPTIMIZER"}],"properties":{"Node name for S&R":"PtoAdam"},"widgets_values":[0.001,0.9,0.999]},{"id":56,"type":"MarkdownNote","pos":[2502.79443359375,2070.234130859375],"size":[210,58.94380569458008],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Save model"],"color":"#432","bgcolor":"#653"},{"id":51,"type":"PandasShowText","pos":[2503.911376953125,2185.8603515625],"size":[576.9476318359375,81.15640258789062],"flags":{},"order":34,"mode":0,"inputs":[{"name":"text","type":"STRING","link":70,"widget":{"name":"text"}}],"outputs":[{"name":"STRING","type":"STRING","links":null,"shape":6,"localized_name":"STRING"}],"properties":{"Node name for S&R":"PandasShowText"},"widgets_values":["","/home/dockeruser/comfy/ComfyUI/custom_nodes/pt-wrapper/models/fashion_mnist_chained_model.pt"]},{"id":54,"type":"MarkdownNote","pos":[1491.0869140625,2225.249755859375],"size":[210,58.94380569458008],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Load val data"],"color":"#432","bgcolor":"#653"},{"id":48,"type":"PtvDatasetLoader","pos":[1804.6444091796875,2226.46533203125],"size":[309.6732482910156,246.00001525878906],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[{"name":"PTDATALOADER","type":"PTDATALOADER","links":[67],"slot_index":0,"localized_name":"PTDATALOADER"}],"properties":{"Node name for S&R":"PtvDatasetLoader"},"widgets_values":["FashionMNIST",true,"",128,false,"{\"train\":False}","{\"num_workers\":1}"]},{"id":47,"type":"PtvDatasetLoader","pos":[1804.6444091796875,1913.2149658203125],"size":[314.89654541015625,246],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[{"name":"PTDATALOADER","type":"PTDATALOADER","links":[66],"slot_index":0,"localized_name":"PTDATALOADER"}],"properties":{"Node name for S&R":"PtvDatasetLoader"},"widgets_values":["FashionMNIST",true,"",128,true,"{\"train\":True}","{\"num_workers\":1}"]},{"id":72,"type":"PtnMaxPool2d","pos":[626.22412109375,-96.74343872070312],"size":[315,130],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[91],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnMaxPool2d"},"widgets_values":["2","2","0","1"]},{"id":73,"type":"PtnChainedModel","pos":[1019.4572143554688,-169.1027374267578],"size":[214.20001220703125,66],"flags":{},"order":22,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":124,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":91,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":93,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[99],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":62,"type":"PtnConv2d","pos":[626.22412109375,225.7763214111328],"size":[315,250],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[100],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnConv2d"},"widgets_values":[32,64,"3","1","same","1",1,true,"zeros"]},{"id":74,"type":"PtnMaxPool2d","pos":[626.22412109375,565.6092529296875],"size":[315,130],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[102],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnMaxPool2d"},"widgets_values":["2","2","0","1"]},{"id":79,"type":"PtnChainedModel","pos":[1019.4572143554688,902.8997192382812],"size":[214.20001220703125,66],"flags":{},"order":25,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":103,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":104,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":null,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[105],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":64,"type":"PtnChainedModel","pos":[1019.4572143554688,1159.224853515625],"size":[214.20001220703125,66],"flags":{},"order":26,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":105,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":106,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":76,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[107],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":58,"type":"PtnConv2d","pos":[626.22412109375,1401.9730224609375],"size":[315,250],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[108],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnConv2d"},"widgets_values":[128,256,"3","1","same","1",1,true,"zeros"]},{"id":81,"type":"PtnChainedModel","pos":[1019.4572143554688,1409.4945068359375],"size":[214.20001220703125,66],"flags":{},"order":27,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":107,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":108,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":null,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[109],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":57,"type":"PtnConvModel","pos":[52.205570220947266,549.4094848632812],"size":[315,202],"flags":{},"order":8,"mode":2,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnConvModel"},"widgets_values":["(1,28,28)",0,10,"[32,64,128,256,512]","[3,3,3,3,1]","[1,1,1,1,0]","[True,True,True,True,False]"]},{"id":52,"type":"MarkdownNote","pos":[627.2979736328125,-549.5452880859375],"size":[210,58.94380569458008],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Define model"],"color":"#432","bgcolor":"#653"},{"id":82,"type":"MarkdownNote","pos":[47.48865509033203,397.1159973144531],"size":[336.3369445800781,82.82988739013672],"flags":{},"order":10,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Equivalent of below model"],"color":"#432","bgcolor":"#653"},{"id":53,"type":"MarkdownNote","pos":[1491.0869140625,1916.8900146484375],"size":[210,58.94380569458008],"flags":{},"order":11,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Load train data"],"color":"#432","bgcolor":"#653"},{"id":55,"type":"MarkdownNote","pos":[2205.1328125,2272.39453125],"size":[210,58.94380569458008],"flags":{},"order":12,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Train"],"color":"#432","bgcolor":"#653"},{"id":19,"type":"PtSaveModel","pos":[2499.0068359375,1958.690673828125],"size":[418.03662109375,64.53935241699219],"flags":{},"order":33,"mode":0,"inputs":[{"name":"model","type":"PTMODEL","link":71,"localized_name":"model"}],"outputs":[{"name":"model full path","type":"STRING","links":[70],"slot_index":0,"localized_name":"model full path"}],"properties":{"Node name for S&R":"PtSaveModel"},"widgets_values":["fashion_mnist_chained_model.pt"]},{"id":70,"type":"PtnConv2d","pos":[626.22412109375,-409.7171936035156],"size":[315,250],"flags":{},"order":13,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[121],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnConv2d"},"widgets_values":[1,32,"3","1","same","1",1,true,"zeros"]},{"id":84,"type":"PtnPreAddChannelAxis","pos":[1019.4572143554688,-410.7212829589844],"size":[211.08056640625,30.150875091552734],"flags":{},"order":20,"mode":0,"inputs":[{"name":"model","type":"PTMODEL","link":121,"localized_name":"model"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[124],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnPreAddChannelAxis"},"widgets_values":[]},{"id":78,"type":"PtnChainedModel","pos":[1019.4572143554688,376.3096008300781],"size":[214.20001220703125,66],"flags":{},"order":23,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":99,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":100,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":null,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[125],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":71,"type":"PtnChainedModel","pos":[1019.4572143554688,561.9466552734375],"size":[214.20001220703125,66],"flags":{},"order":24,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":125,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":102,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":89,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[103],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":76,"type":"PtnMaxPool2d","pos":[626.22412109375,1727.632080078125],"size":[315,130],"flags":{},"order":14,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[110],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnMaxPool2d"},"widgets_values":["2","2","0","1"]},{"id":61,"type":"PtnConv2d","pos":[626.22412109375,826.7774047851562],"size":[315,250],"flags":{},"order":15,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[104],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnConv2d"},"widgets_values":[64,128,"3","1","same","1",1,true,"zeros"]},{"id":75,"type":"PtnMaxPool2d","pos":[626.22412109375,1152.7255859375],"size":[315,130],"flags":{},"order":16,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[106],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnMaxPool2d"},"widgets_values":["2","2","0","1"]},{"id":67,"type":"PtnChainedModel","pos":[1019.4572143554688,1719.1153564453125],"size":[214.20001220703125,66],"flags":{},"order":28,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":109,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":110,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":79,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[129],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":59,"type":"PtnConv2d","pos":[626.22412109375,1989.2188720703125],"size":[315,250],"flags":{},"order":17,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[130],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnConv2d"},"widgets_values":[256,512,"1","1","0","1",1,false,"zeros"]},{"id":65,"type":"PtfReLU","pos":[133.952392578125,2035.114501953125],"size":[210,26],"flags":{},"order":18,"mode":0,"inputs":[],"outputs":[{"name":"PTCALLABLE","type":"PTCALLABLE","links":[76,79,89,93,131],"slot_index":0,"localized_name":"PTCALLABLE"}],"properties":{"Node name for S&R":"PtfReLU"},"widgets_values":[]},{"id":85,"type":"PtnPreFlatten","pos":[626.22412109375,2341.22021484375],"size":[210,26],"flags":{},"order":21,"mode":0,"inputs":[{"name":"model","type":"PTMODEL","link":128,"localized_name":"model"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[132],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnPreFlatten"},"widgets_values":[]},{"id":87,"type":"PtnChainedModel","pos":[1019.4572143554688,2068.581787109375],"size":[214.20001220703125,66],"flags":{},"order":29,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":129,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":130,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":131,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[133],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":80,"type":"PtnChainedModel","pos":[1019.4572143554688,2341.22021484375],"size":[214.20001220703125,66],"flags":{},"order":30,"mode":0,"inputs":[{"name":"model_a","type":"PTMODEL","link":133,"localized_name":"model_a"},{"name":"model_b","type":"PTMODEL","link":132,"localized_name":"model_b"},{"name":"closure","type":"PTCALLABLE","link":null,"shape":7,"localized_name":"closure"}],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[117,118],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnChainedModel"},"widgets_values":[]},{"id":86,"type":"PtnLinear","pos":[243.826416015625,2341.22021484375],"size":[315,106],"flags":{},"order":19,"mode":0,"inputs":[],"outputs":[{"name":"PTMODEL","type":"PTMODEL","links":[128],"slot_index":0,"localized_name":"PTMODEL"}],"properties":{"Node name for S&R":"PtnLinear"},"widgets_values":[512,10,true]}],"links":[[66,47,0,50,1,"PTDATALOADER"],[67,48,0,50,3,"PTDATALOADER"],[68,11,0,50,2,"PTOPTIMIZER"],[70,19,0,51,0,"STRING"],[71,50,0,19,0,"PTMODEL"],[76,65,0,64,2,"PTCALLABLE"],[79,65,0,67,2,"PTCALLABLE"],[89,65,0,71,2,"PTCALLABLE"],[91,72,0,73,1,"PTMODEL"],[93,65,0,73,2,"PTCALLABLE"],[99,73,0,78,0,"PTMODEL"],[100,62,0,78,1,"PTMODEL"],[102,74,0,71,1,"PTMODEL"],[103,71,0,79,0,"PTMODEL"],[104,61,0,79,1,"PTMODEL"],[105,79,0,64,0,"PTMODEL"],[106,75,0,64,1,"PTMODEL"],[107,64,0,81,0,"PTMODEL"],[108,58,0,81,1,"PTMODEL"],[109,81,0,67,0,"PTMODEL"],[110,76,0,67,1,"PTMODEL"],[117,80,0,11,0,"PTMODEL"],[118,80,0,50,0,"PTMODEL"],[121,70,0,84,0,"PTMODEL"],[124,84,0,73,0,"PTMODEL"],[125,78,0,71,0,"PTMODEL"],[128,86,0,85,0,"PTMODEL"],[129,67,0,87,0,"PTMODEL"],[130,59,0,87,1,"PTMODEL"],[131,65,0,87,2,"PTCALLABLE"],[132,85,0,80,1,"PTMODEL"],[133,87,0,80,0,"PTMODEL"]],"groups":[],"config":{},"extra":{"ds":{"scale":0.6033368359683484,"offset":[-1953.2206104686907,-3068.2635967230185]},"node_versions":{"pt-wrapper":"a9870974df89837b31ce0a68cd9cd91c1fd6eb6a","data-analysis":"e490b620286600930c8c9d3a6986f73d5320463f"},"ue_links":[]},"version":0.4}